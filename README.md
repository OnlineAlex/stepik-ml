# Соревнование Stepik ML

Нужно было предсказать, сможет ли пользователь успешно закончить онлайн курс "Анализ данных в R". Результатом проверки точности предсказаний было значение ROC AUC score.


В репозитории находится ноутбук с финальным решением. Анализ данных и неудачные гипотезы вырезаны. Этот вариант решения показал лучший(на момент соревнования) результат.
**ROC AUC: 0.8937**


## Данные

### Для обучения 
- **/datasets/event_data_train.zip** — данные о действиях, которые совершают студенты со стэпами:
  - step_id - id стэпа
  - user_id - анонимизированный id юзера.
  - timestamp - время наступления события в формате unix date.
  - action - событие, возможные значения: 
    - started_attempt - начало попытки решить.
    - passed - удачное решение практического шага.

- **/datasets/submissions_data_train.zip** — данные о времени и статусах сабмитов к практическим заданиям:
  - step_id - id стэпа.
  - timestamp - время отправки решения в формате unix date.
  - submission_status - статус решения.
  - user_id - анонимизированный id юзера.

### Для предсказания
- **/datasets/event_data_test.zip** — как и *event_data_train.zip*, но содержит данные за первые 2 дня.

- **/datasets/submissions_data_test.zip** — как и *submissions_data_train.zip*, но содержит данные за первые 2 дня.
 
## Требования

Для корректной работы требуется:
- Python версии 3.7 и выше
- Jupyter notebook версии 5.7 и выше

И  пакетов из requirements.txt
```bash
pip install -r requirements.txt # или командой pip3
``` 
 
 
## Как делать предсказания на новых данных

```python
# Загружаете новые данные
events_t = pd.read_csv("./datasets/events_data_test.zip")
submissions_t = pd.read_csv("./datasets/submission_data_test.zip")

# Функция create_work_df обрабатывает их и возвращает датасет для предсказаний
X_pred = create_work_df(events_t, submissions_t)
dpred = xgb.DMatrix(X_pred.drop(['user_id'], axis=1), missing=-99)

# Предсказание
pred_proba = gbm.predict(dpred)
X_pred['is_gone'] = pred_proba

# Сохранение данных в текущую папку
X_pred[['user_id', 'is_gone']].to_csv(f'my_pdedict_{str(gbm.best_score)[2:6]}.csv', index=False)

```

## Результаты 
Пример таблицы с результатами:

|user_id|is_gone|
|----|------|
|4	|0.0003625353|
|6	|0.0003625353|
|10|	0.0003625353|
|12|	0.04967224|
|13|	0.5714445|
|15|	0.21236384|


## Что дальше?
#### Студентам
На основе готового решения можно опробовать свои гипотезы и повысить результат. Соревнование: [Stepik ML contest](https://stepik.org/lesson/226979/step/1) 
#### Преподавателям Степика
Для каждого курса требуется установить свой порог прохождения и id степов. Данные помогут в первые дни определять студентов, которые собираются покинуть курс. Таких юзером можно подбодрить или мотивировать. 